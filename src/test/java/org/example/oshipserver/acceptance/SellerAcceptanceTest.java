package org.example.oshipserver.acceptance;

import com.fasterxml.jackson.core.type.TypeReference;
import com.fasterxml.jackson.databind.JsonNode;
import com.fasterxml.jackson.databind.ObjectMapper;
import org.example.oshipserver.domain.auth.dto.request.AuthAddressRequest;
import org.example.oshipserver.domain.auth.dto.request.LoginRequest;
import org.example.oshipserver.domain.auth.dto.request.PartnerSignupRequest;
import org.example.oshipserver.domain.auth.dto.request.SellerSignupRequest;
import org.example.oshipserver.domain.order.dto.response.OrderListResponse;
import org.example.oshipserver.domain.payment.dto.request.MultiPaymentConfirmRequest;
import org.example.oshipserver.global.common.response.PageResponseDto;
import org.junit.jupiter.api.*;
import org.junit.jupiter.api.extension.ExtendWith;
import org.springframework.beans.factory.annotation.Autowired;
import org.springframework.boot.test.autoconfigure.web.servlet.AutoConfigureMockMvc;
import org.springframework.boot.test.context.SpringBootTest;
import org.springframework.http.MediaType;
import org.springframework.jdbc.core.JdbcTemplate;
import org.springframework.mock.web.MockMultipartFile;
import org.springframework.test.annotation.DirtiesContext;
import org.springframework.test.context.ActiveProfiles;
import org.springframework.test.context.DynamicPropertyRegistry;
import org.springframework.test.context.DynamicPropertySource;
import org.springframework.test.context.junit.jupiter.SpringExtension;
import org.springframework.test.web.servlet.MockMvc;
import org.springframework.test.web.servlet.MvcResult;
import org.testcontainers.containers.GenericContainer;
import org.testcontainers.containers.MySQLContainer;
import org.testcontainers.containers.wait.strategy.Wait;
import org.testcontainers.junit.jupiter.Container;
import org.testcontainers.junit.jupiter.Testcontainers;

import java.io.File;
import java.io.FileInputStream;
import java.time.Duration;
import java.util.List;

import static org.assertj.core.api.Assertions.assertThat;
import static org.springframework.test.web.servlet.request.MockMvcRequestBuilders.*;
import static org.springframework.test.web.servlet.result.MockMvcResultMatchers.jsonPath;
import static org.springframework.test.web.servlet.result.MockMvcResultMatchers.status;
@ActiveProfiles("local")
@Testcontainers
@SpringBootTest
@AutoConfigureMockMvc
@DirtiesContext(classMode = DirtiesContext.ClassMode.AFTER_CLASS)
@TestMethodOrder(MethodOrderer.OrderAnnotation.class)
@ExtendWith(SpringExtension.class)
public class SellerAcceptanceTest {

    @Autowired
    private MockMvc mockMvc;

    @Autowired
    private ObjectMapper objectMapper;

    @Autowired
    private JdbcTemplate jdbcTemplate;

    private static String jwt;
    private static List<MultiPaymentConfirmRequest.MultiOrderRequest> orderList;

    @Container
    private static final MySQLContainer<?> mysql = new MySQLContainer<>("mysql:8.0")
            .withDatabaseName("testdb")
            .withUsername("testuser")
            .withPassword("testpass")
            .withStartupTimeout(Duration.ofSeconds(30))
            .waitingFor(Wait.forListeningPort());

    @Container
    private static final GenericContainer<?> redis = new GenericContainer<>("redis:7.0.12")
            .withExposedPorts(6379)
            .waitingFor(Wait.forListeningPort())
            .withStartupTimeout(Duration.ofSeconds(30));


    @DynamicPropertySource
    static void overrideProps(DynamicPropertyRegistry registry) {
        registry.add("spring.datasource.url", mysql::getJdbcUrl);
        registry.add("spring.datasource.username", mysql::getUsername);
        registry.add("spring.datasource.password", mysql::getPassword);
        registry.add("spring.datasource.driver-class-name", mysql::getDriverClassName);
        String host = redis.getHost();
        Integer port = redis.getMappedPort(6379);
        registry.add("spring.data.redis.host", () -> host);
        registry.add("spring.data.redis.port", () -> port);
    }

    @Test
    @Order(0)
    void init() throws Exception {
        PartnerSignupRequest signupRequest = new PartnerSignupRequest(
                "partner@test.com", "password123", "PARTNER",
                "홍", "길동", "01011112222",
                new AuthAddressRequest("KR", "서울", "강남", "테헤란로", "101호", "06222")
        );

        mockMvc.perform(post("/api/v1/auth/partners/signup")
                        .contentType(MediaType.APPLICATION_JSON)
                        .content(objectMapper.writeValueAsString(signupRequest)))
                .andExpect(status().isCreated());

        PartnerSignupRequest signupRequest2 = new PartnerSignupRequest(
                "partne2r@test.com", "password123", "PARTNER",
                "홍", "길동", "01011112223",
                new AuthAddressRequest("KR", "서울", "강남", "테헤란로", "101호", "06222")
        );

        mockMvc.perform(post("/api/v1/auth/partners/signup")
                        .contentType(MediaType.APPLICATION_JSON)
                        .content(objectMapper.writeValueAsString(signupRequest2)))
                .andExpect(status().isCreated());

        String sql = """
        INSERT INTO carriers (
            partner_id, name, description, weight_min, weight_max, service, token, api_key, secret_key, account_number, created_at, modified_at, expired
        ) VALUES
        (1, 'FEDEX', 'FedEx 국제 특급배송', 1.00, 100.00, 'IP', '', 'l788a926ae84234515a4f8136947b2f360', 'a1199da2557e430389c2ecadb06134aa', '740561073', NOW(), NOW(), '2025-12-31 23:59:59.000000'),
        (1, 'FEDEX', 'FedEx 국제 특급배송', 0.50, 200.00, 'IP', '', 'l788a926ae84234515a4f8136947b2f360', 'a1199da2557e430389c2ecadb06134aa', '740561073', NOW(), NOW(), '2025-12-31 23:59:59.000000'),
        (1, 'FEDEX', 'FedEx 국제 특급배송', 1.50, 150.00, 'IP', '', 'l788a926ae84234515a4f8136947b2f360', 'a1199da2557e430389c2ecadb06134aa', '740561073', NOW(), NOW(), '2025-12-31 23:59:59.000000'),
        (1, 'FEDEX', 'FedEx 국제 특급배송', 0.80, 120.00, 'IP', '', 'l788a926ae84234515a4f8136947b2f360', 'a1199da2557e430389c2ecadb06134aa', '740561073', NOW(), NOW(), '2025-12-31 23:59:59.000000'),
        (1, 'FEDEX', 'FedEx 국제 특급배송', 2.00, 300.00, 'IP', '', 'l788a926ae84234515a4f8136947b2f360', 'a1199da2557e430389c2ecadb06134aa', '740561073', NOW(), NOW(), '2025-12-31 23:59:59.000000'),
        (2, 'FEDEX', 'FedEx 국제 특급배송', 0.30, 80.00, 'IP', '', 'l788a926ae84234515a4f8136947b2f360', 'a1199da2557e430389c2ecadb06134aa', '740561073', NOW(), NOW(), '2025-12-31 23:59:59.000000'),
        (2, 'FEDEX', 'FedEx 국제 특급배송', 0.10, 10.00, 'IP', '', 'l788a926ae84234515a4f8136947b2f360', 'a1199da2557e430389c2ecadb06134aa', '740561073', NOW(), NOW(), '2025-12-31 23:59:59.000000'),
        (2, 'FEDEX', 'FedEx 국제 특급배송', 5.00, 500.00, 'IP', '', 'l788a926ae84234515a4f8136947b2f360', 'a1199da2557e430389c2ecadb06134aa', '740561073', NOW(), NOW(), '2025-12-31 23:59:59.000000'),
        (2, 'FEDEX', 'FedEx 국제 특급배송', 10.00, 1000.00, 'IP', '', 'l788a926ae84234515a4f8136947b2f360', 'a1199da2557e430389c2ecadb06134aa', '740561073', NOW(), NOW(), '2025-12-31 23:59:59.000000'),
        (2, 'FEDEX', 'FedEx 국제 특급배송', 20.00, 2000.00, 'IP', '', 'l788a926ae84234515a4f8136947b2f360', 'a1199da2557e430389c2ecadb06134aa', '740561073', NOW(), NOW(), '2025-12-31 23:59:59.000000')
    """;

        jdbcTemplate.execute(sql);

        String sql2 = """
        INSERT INTO carrier_countries
        (id, created_at, modified_at, country_code, zone_no, carrier_id)
        VALUES
        (1,  '2025-04-01 12:00:00.000000', '2025-04-01 12:00:00.000000', 'US', 1,  1),
        (2,  '2025-04-02 12:00:00.000000', '2025-04-02 12:00:00.000000', 'CA', 1,  2),
        (3,  '2025-04-03 12:00:00.000000', '2025-04-03 12:00:00.000000', 'US', 1,  3),
        (4,  '2025-04-04 12:00:00.000000', '2025-04-04 12:00:00.000000', 'CN', 1,  4),
        (5,  '2025-04-05 12:00:00.000000', '2025-04-05 12:00:00.000000', 'US', 1,  5),
        (6,  '2025-04-06 12:00:00.000000', '2025-04-06 12:00:00.000000', 'DE', 1,  6),
        (7,  '2025-04-07 12:00:00.000000', '2025-04-07 12:00:00.000000', 'US', 1,  7),
        (8,  '2025-04-08 12:00:00.000000', '2025-04-08 12:00:00.000000', 'GB', 1,  8),
        (9,  '2025-04-09 12:00:00.000000', '2025-04-09 12:00:00.000000', 'US', 1,  9),
        (10, '2025-04-10 12:00:00.000000', '2025-04-10 12:00:00.000000', 'SG', 1, 10)
    """;

        jdbcTemplate.execute(sql2);

        String sql3 = """
                INSERT INTO carrier_rate_charges
                (created_at, modified_at, amount, weight,  zone_index, carrier_id)
                VALUES
                ('2025-01-01 00:00:00.000000', '2025-01-01 00:00:00.000000', 1000.00,   1.00, 1,  1),
                ('2025-01-01 00:01:00.000000', '2025-01-01 00:01:00.000000', 1500.00,   1.50, 1,  1),
                ('2025-01-01 00:02:00.000000', '2025-01-01 00:02:00.000000', 2000.00,   2.00, 1,  1),
                ('2025-01-01 00:03:00.000000', '2025-01-01 00:03:00.000000', 2500.00,   2.50, 1,  1),
                ('2025-01-01 00:04:00.000000', '2025-01-01 00:04:00.000000', 3000.00,   3.00, 1,  1),
                ('2025-01-01 00:05:00.000000', '2025-01-01 00:05:00.000000', 3500.00,   3.50, 1,  1),
                ('2025-01-01 00:06:00.000000', '2025-01-01 00:06:00.000000', 4000.00,   4.00, 1,  1),
                ('2025-01-01 00:07:00.000000', '2025-01-01 00:07:00.000000', 4500.00,   4.50, 1,  1),
                ('2025-01-01 00:08:00.000000', '2025-01-01 00:08:00.000000', 5000.00,   5.00, 1,  1),
                ('2025-01-01 00:09:00.000000', '2025-01-01 00:09:00.000000', 5500.00,   5.50, 1,  1),
                ('2025-01-01 00:10:00.000000', '2025-01-01 00:10:00.000000', 6000.00,  6.00, 1,  1),
                ('2025-01-01 00:11:00.000000', '2025-01-01 00:11:00.000000', 6500.00,  6.50, 1,  1),
                ('2025-01-01 00:12:00.000000', '2025-01-01 00:12:00.000000', 7000.00,  7.00, 1,  1),
                ('2025-01-01 00:13:00.000000', '2025-01-01 00:13:00.000000', 7500.00,  7.50, 1,  1),
                ('2025-01-01 00:14:00.000000', '2025-01-01 00:14:00.000000', 8000.00,  8.00, 1,  1),
                ('2025-01-01 00:15:00.000000', '2025-01-01 00:15:00.000000', 8500.00,  8.50, 1,  1),
                ('2025-01-01 00:16:00.000000', '2025-01-01 00:16:00.000000', 9000.00,  9.00, 1,  1),
                ('2025-01-01 00:17:00.000000', '2025-01-01 00:17:00.000000', 9500.00,  9.50, 1,  1),
                ('2025-01-01 00:18:00.000000', '2025-01-01 00:18:00.000000',10000.00, 10.00, 1,  1),
                ('2025-01-01 00:19:00.000000', '2025-01-01 00:19:00.000000',10500.00, 10.50, 1,  1),
                ('2025-01-01 00:20:00.000000', '2025-01-01 00:20:00.000000',11000.00, 11.00, 1,  1),
                ('2025-01-01 00:21:00.000000', '2025-01-01 00:21:00.000000',11500.00, 11.50, 1,  1),
                ('2025-01-01 00:22:00.000000', '2025-01-01 00:22:00.000000',12000.00, 12.00, 1,  1),
                ('2025-01-01 00:23:00.000000', '2025-01-01 00:23:00.000000',12500.00, 12.50, 1,  1),
                ('2025-01-01 00:24:00.000000', '2025-01-01 00:24:00.000000',13000.00, 13.00, 1,  1),
                ('2025-01-01 00:25:00.000000', '2025-01-01 00:25:00.000000',13500.00, 13.50, 1,  1),
                ('2025-01-01 00:26:00.000000', '2025-01-01 00:26:00.000000',14000.00, 14.00, 1,  1),
                ('2025-01-01 00:27:00.000000', '2025-01-01 00:27:00.000000',14500.00, 14.50, 1,  1),
                ('2025-01-01 00:28:00.000000', '2025-01-01 00:28:00.000000',15000.00, 15.00, 1,  1),
                ('2025-01-01 00:29:00.000000', '2025-01-01 00:29:00.000000',15500.00, 15.50, 1,  1),
                ('2025-01-01 00:30:00.000000', '2025-01-01 00:30:00.000000',16000.00, 16.00, 1,  1),
                ('2025-01-01 00:31:00.000000', '2025-01-01 00:31:00.000000',16500.00, 16.50, 1,  1),
                ('2025-01-01 00:32:00.000000', '2025-01-01 00:32:00.000000',17000.00, 17.00, 1,  1),
                ('2025-01-01 00:33:00.000000', '2025-01-01 00:33:00.000000',17500.00, 17.50, 1,  1),
                ('2025-01-01 00:34:00.000000', '2025-01-01 00:34:00.000000',18000.00, 18.00, 1,  1),
                ('2025-01-01 00:35:00.000000', '2025-01-01 00:35:00.000000',18500.00, 18.50, 1,  1),
                ('2025-01-01 00:36:00.000000', '2025-01-01 00:36:00.000000',19000.00, 19.00, 1,  1),
                ('2025-01-01 00:37:00.000000', '2025-01-01 00:37:00.000000',19500.00, 19.50, 1,  1),
                ('2025-01-01 00:38:00.000000', '2025-01-01 00:38:00.000000',20000.00, 20.00, 1,  1),
                ('2025-01-01 00:00:00.000000', '2025-01-01 00:00:00.000000', 1010.00,   1.00, 1, 2),
                ('2025-01-01 00:01:00.000000', '2025-01-01 00:01:00.000000', 1510.00,   1.50, 1, 2),
                ('2025-01-01 00:02:00.000000', '2025-01-01 00:02:00.000000', 2010.00,   2.00, 1, 2),
                ('2025-01-01 00:03:00.000000', '2025-01-01 00:03:00.000000', 2510.00,   2.50, 1, 2),
                ('2025-01-01 00:04:00.000000', '2025-01-01 00:04:00.000000', 3010.00,   3.00, 1, 2),
                ('2025-01-01 00:05:00.000000', '2025-01-01 00:05:00.000000', 3510.00,   3.50, 1, 2),
                ('2025-01-01 00:06:00.000000', '2025-01-01 00:06:00.000000', 4010.00,   4.00, 1, 2),
                ('2025-01-01 00:07:00.000000', '2025-01-01 00:07:00.000000', 4510.00,   4.50, 1, 2),
                ('2025-01-01 00:08:00.000000', '2025-01-01 00:08:00.000000', 5010.00,   5.00, 1, 2),
                ('2025-01-01 00:09:00.000000', '2025-01-01 00:09:00.000000', 5501.00,  5.50, 1,  2),
                ('2025-01-01 00:10:00.000000', '2025-01-01 00:10:00.000000', 6001.00,  6.00, 1,  2),
                ('2025-01-01 00:11:00.000000', '2025-01-01 00:11:00.000000', 6501.00,  6.50, 1,  2),
                ('2025-01-01 00:12:00.000000', '2025-01-01 00:12:00.000000', 7001.00,  7.00, 1,  2),
                ('2025-01-01 00:13:00.000000', '2025-01-01 00:13:00.000000', 7501.00,  7.50, 1,  2),
                ('2025-01-01 00:14:00.000000', '2025-01-01 00:14:00.000000', 8001.00,  8.00, 1,  2),
                ('2025-01-01 00:15:00.000000', '2025-01-01 00:15:00.000000', 8501.00,  8.50, 1,  2),
                ('2025-01-01 00:16:00.000000', '2025-01-01 00:16:00.000000', 9001.00,  9.00, 1,  2),
                ('2025-01-01 00:17:00.000000', '2025-01-01 00:17:00.000000', 9501.00,  9.50, 1,  2),
                ('2025-01-01 00:18:00.000000', '2025-01-01 00:18:00.000000',10001.00, 10.00, 1,  2),
                ('2025-01-01 00:19:00.000000', '2025-01-01 00:19:00.000000',10501.00, 10.50, 1,  2),
                ('2025-01-01 00:20:00.000000', '2025-01-01 00:20:00.000000',11001.00, 11.00, 1,  2),
                ('2025-01-01 00:21:00.000000', '2025-01-01 00:21:00.000000',11501.00, 11.50, 1,  2),
                ('2025-01-01 00:22:00.000000', '2025-01-01 00:22:00.000000',12001.00, 12.00, 1,  2),
                ('2025-01-01 00:23:00.000000', '2025-01-01 00:23:00.000000',12501.00, 12.50, 1,  2),
                ('2025-01-01 00:24:00.000000', '2025-01-01 00:24:00.000000',13001.00, 13.00, 1,  2),
                ('2025-01-01 00:25:00.000000', '2025-01-01 00:25:00.000000',13501.00, 13.50, 1,  2),
                ('2025-01-01 00:26:00.000000', '2025-01-01 00:26:00.000000',14001.00, 14.00, 1,  2),
                ('2025-01-01 00:27:00.000000', '2025-01-01 00:27:00.000000',14501.00, 14.50, 1,  2),
                ('2025-01-01 00:28:00.000000', '2025-01-01 00:28:00.000000',15001.00, 15.00, 1,  2),
                ('2025-01-01 00:29:00.000000', '2025-01-01 00:29:00.000000',15501.00, 15.50, 1,  2),
                ('2025-01-01 00:30:00.000000', '2025-01-01 00:30:00.000000',16001.00, 16.00, 1,  2),
                ('2025-01-01 00:31:00.000000', '2025-01-01 00:31:00.000000',16501.00, 16.50, 1,  2),
                ('2025-01-01 00:32:00.000000', '2025-01-01 00:32:00.000000',17001.00, 17.00, 1,  2),
                ('2025-01-01 00:33:00.000000', '2025-01-01 00:33:00.000000',17501.00, 17.50, 1,  2),
                ('2025-01-01 00:34:00.000000', '2025-01-01 00:34:00.000000',18001.00, 18.00, 1,  2),
                ('2025-01-01 00:35:00.000000', '2025-01-01 00:35:00.000000',18501.00, 18.50, 1,  2),
                ('2025-01-01 00:36:00.000000', '2025-01-01 00:36:00.000000',19001.00, 19.00, 1,  2),
                ('2025-01-01 00:37:00.000000', '2025-01-01 00:37:00.000000',19501.00, 19.50, 1,  2),
                ('2025-01-01 00:38:00.000000', '2025-01-01 00:38:00.000000',20001.00, 20.00, 1,  2),
                ('2025-01-01 00:00:00.000000', '2025-01-01 00:00:00.000000', 1020.00,  1.00, 1,  3),
                ('2025-01-01 00:01:00.000000', '2025-01-01 00:01:00.000000', 1520.00,  1.50, 1,  3),
                ('2025-01-01 00:02:00.000000', '2025-01-01 00:02:00.000000', 2020.00,  2.00, 1,  3),
                ('2025-01-01 00:03:00.000000', '2025-01-01 00:03:00.000000', 2520.00,  2.50, 1,  3),
                ('2025-01-01 00:04:00.000000', '2025-01-01 00:04:00.000000', 3020.00,  3.00, 1,  3),
                ('2025-01-01 00:05:00.000000', '2025-01-01 00:05:00.000000', 3520.00,  3.50, 1,  3),
                ('2025-01-01 00:06:00.000000', '2025-01-01 00:06:00.000000', 4020.00,  4.00, 1,  3),
                ('2025-01-01 00:07:00.000000', '2025-01-01 00:07:00.000000', 4520.00,  4.50, 1,  3),
                ('2025-01-01 00:08:00.000000', '2025-01-01 00:08:00.000000', 5020.00,  5.00, 1,  3),
                ('2025-01-01 00:09:00.000000', '2025-01-01 00:09:00.000000', 5521.00,  5.50, 1,  3),
                ('2025-01-01 00:10:00.000000', '2025-01-01 00:10:00.000000', 6021.00,  6.00, 1,  3),
                ('2025-01-01 00:11:00.000000', '2025-01-01 00:11:00.000000', 6521.00,  6.50, 1,  3),
                ('2025-01-01 00:12:00.000000', '2025-01-01 00:12:00.000000', 7021.00,  7.00, 1,  3),
                ('2025-01-01 00:13:00.000000', '2025-01-01 00:13:00.000000', 7521.00,  7.50, 1,  3),
                ('2025-01-01 00:14:00.000000', '2025-01-01 00:14:00.000000', 8021.00,  8.00, 1,  3),
                ('2025-01-01 00:15:00.000000', '2025-01-01 00:15:00.000000', 8521.00,  8.50, 1,  3),
                ('2025-01-01 00:16:00.000000', '2025-01-01 00:16:00.000000', 9021.00,  9.00, 1,  3),
                ('2025-01-01 00:17:00.000000', '2025-01-01 00:17:00.000000', 9521.00,  9.50, 1,  3),
                ('2025-01-01 00:18:00.000000', '2025-01-01 00:18:00.000000',10021.00, 10.00, 1,  3),
                ('2025-01-01 00:19:00.000000', '2025-01-01 00:19:00.000000',10521.00, 10.50, 1,  3),
                ('2025-01-01 00:20:00.000000', '2025-01-01 00:20:00.000000',11021.00, 11.00, 1,  3),
                ('2025-01-01 00:21:00.000000', '2025-01-01 00:21:00.000000',11521.00, 11.50, 1,  3),
                ('2025-01-01 00:22:00.000000', '2025-01-01 00:22:00.000000',12021.00, 12.00, 1,  3),
                ('2025-01-01 00:23:00.000000', '2025-01-01 00:23:00.000000',12521.00, 12.50, 1,  3),
                ('2025-01-01 00:24:00.000000', '2025-01-01 00:24:00.000000',13021.00, 13.00, 1,  3),
                ('2025-01-01 00:25:00.000000', '2025-01-01 00:25:00.000000',13521.00, 13.50, 1,  3),
                ('2025-01-01 00:26:00.000000', '2025-01-01 00:26:00.000000',14021.00, 14.00, 1,  3),
                ('2025-01-01 00:27:00.000000', '2025-01-01 00:27:00.000000',14521.00, 14.50, 1,  3),
                ('2025-01-01 00:28:00.000000', '2025-01-01 00:28:00.000000',15021.00, 15.00, 1,  3),
                ('2025-01-01 00:29:00.000000', '2025-01-01 00:29:00.000000',15521.00, 15.50, 1,  3),
                ('2025-01-01 00:30:00.000000', '2025-01-01 00:30:00.000000',16021.00, 16.00, 1,  3),
                ('2025-01-01 00:31:00.000000', '2025-01-01 00:31:00.000000',16521.00, 16.50, 1,  3),
                ('2025-01-01 00:32:00.000000', '2025-01-01 00:32:00.000000',17021.00, 17.00, 1,  3),
                ('2025-01-01 00:33:00.000000', '2025-01-01 00:33:00.000000',17521.00, 17.50, 1,  3),
                ('2025-01-01 00:34:00.000000', '2025-01-01 00:34:00.000000',18021.00, 18.00, 1,  3),
                ('2025-01-01 00:35:00.000000', '2025-01-01 00:35:00.000000',18521.00, 18.50, 1,  3),
                ('2025-01-01 00:36:00.000000', '2025-01-01 00:36:00.000000',19021.00, 19.00, 1,  3),
                ('2025-01-01 00:37:00.000000', '2025-01-01 00:37:00.000000',19521.00, 19.50, 1,  3),
                ('2025-01-01 00:38:00.000000', '2025-01-01 00:38:00.000000',20021.00, 20.00, 1,  3),
                ('2025-01-01 00:00:00.000000', '2025-01-01 00:00:00.000000', 1040.00,  1.00, 1,  4),
                ('2025-01-01 00:01:00.000000', '2025-01-01 00:01:00.000000', 1540.00,  1.50, 1,  4),
                ('2025-01-01 00:02:00.000000', '2025-01-01 00:02:00.000000', 2040.00,  2.00, 1,  4),
                ('2025-01-01 00:03:00.000000', '2025-01-01 00:03:00.000000', 2540.00,  2.50, 1,  4),
                ('2025-01-01 00:04:00.000000', '2025-01-01 00:04:00.000000', 3040.00,  3.00, 1,  4),
                ('2025-01-01 00:05:00.000000', '2025-01-01 00:05:00.000000', 3540.00,  3.50, 1,  4),
                ('2025-01-01 00:06:00.000000', '2025-01-01 00:06:00.000000', 4040.00,  4.00, 1,  4),
                ('2025-01-01 00:07:00.000000', '2025-01-01 00:07:00.000000', 4540.00,  4.50, 1,  4),
                ('2025-01-01 00:08:00.000000', '2025-01-01 00:08:00.000000', 5040.00,  5.00, 1,  4),
                ('2025-01-01 00:09:00.000000', '2025-01-01 00:09:00.000000', 5541.00,  5.50, 1,  4),
                ('2025-01-01 00:10:00.000000', '2025-01-01 00:10:00.000000', 6041.00,  6.00, 1,  4),
                ('2025-01-01 00:11:00.000000', '2025-01-01 00:11:00.000000', 6541.00,  6.50, 1,  4),
                ('2025-01-01 00:12:00.000000', '2025-01-01 00:12:00.000000', 7041.00,  7.00, 1,  4),
                ('2025-01-01 00:13:00.000000', '2025-01-01 00:13:00.000000', 7541.00,  7.50, 1,  4),
                ('2025-01-01 00:14:00.000000', '2025-01-01 00:14:00.000000', 8041.00,  8.00, 1,  4),
                ('2025-01-01 00:15:00.000000', '2025-01-01 00:15:00.000000', 8541.00,  8.50, 1,  4),
                ('2025-01-01 00:16:00.000000', '2025-01-01 00:16:00.000000', 9041.00,  9.00, 1,  4),
                ('2025-01-01 00:17:00.000000', '2025-01-01 00:17:00.000000', 9541.00,  9.50, 1,  4),
                ('2025-01-01 00:18:00.000000', '2025-01-01 00:18:00.000000',10041.00, 10.00, 1,  4),
                ('2025-01-01 00:19:00.000000', '2025-01-01 00:19:00.000000',10541.00, 10.50, 1,  4),
                ('2025-01-01 00:20:00.000000', '2025-01-01 00:20:00.000000',11041.00, 11.00, 1,  4),
                ('2025-01-01 00:21:00.000000', '2025-01-01 00:21:00.000000',11541.00, 11.50, 1,  4),
                ('2025-01-01 00:22:00.000000', '2025-01-01 00:22:00.000000',12041.00, 12.00, 1,  4),
                ('2025-01-01 00:23:00.000000', '2025-01-01 00:23:00.000000',12541.00, 12.50, 1,  4),
                ('2025-01-01 00:24:00.000000', '2025-01-01 00:24:00.000000',13041.00, 13.00, 1,  4),
                ('2025-01-01 00:25:00.000000', '2025-01-01 00:25:00.000000',13541.00, 13.50, 1,  4),
                ('2025-01-01 00:26:00.000000', '2025-01-01 00:26:00.000000',14041.00, 14.00, 1,  4),
                ('2025-01-01 00:27:00.000000', '2025-01-01 00:27:00.000000',14541.00, 14.50, 1,  4),
                ('2025-01-01 00:28:00.000000', '2025-01-01 00:28:00.000000',15041.00, 15.00, 1,  4),
                ('2025-01-01 00:29:00.000000', '2025-01-01 00:29:00.000000',15541.00, 15.50, 1,  4),
                ('2025-01-01 00:30:00.000000', '2025-01-01 00:30:00.000000',16041.00, 16.00, 1,  4),
                ('2025-01-01 00:31:00.000000', '2025-01-01 00:31:00.000000',16541.00, 16.50, 1,  4),
                ('2025-01-01 00:32:00.000000', '2025-01-01 00:32:00.000000',17041.00, 17.00, 1,  4),
                ('2025-01-01 00:33:00.000000', '2025-01-01 00:33:00.000000',17541.00, 17.50, 1,  4),
                ('2025-01-01 00:34:00.000000', '2025-01-01 00:34:00.000000',18041.00, 18.00, 1,  4),
                ('2025-01-01 00:35:00.000000', '2025-01-01 00:35:00.000000',18541.00, 18.50, 1,  4),
                ('2025-01-01 00:36:00.000000', '2025-01-01 00:36:00.000000',19041.00, 19.00, 1,  4),
                ('2025-01-01 00:37:00.000000', '2025-01-01 00:37:00.000000',19541.00, 19.50, 1,  4),
                ('2025-01-01 00:38:00.000000', '2025-01-01 00:38:00.000000',20041.00, 20.00, 1,  4),
                ('2025-01-01 00:00:00.000000', '2025-01-01 00:00:00.000000', 1050.00,  1.00, 1,  5),
                ('2025-01-01 00:01:00.000000', '2025-01-01 00:01:00.000000', 1550.00,  1.50, 1,  5),
                ('2025-01-01 00:02:00.000000', '2025-01-01 00:02:00.000000', 2050.00,  2.00, 1,  5),
                ('2025-01-01 00:03:00.000000', '2025-01-01 00:03:00.000000', 2550.00,  2.50, 1,  5),
                ('2025-01-01 00:04:00.000000', '2025-01-01 00:04:00.000000', 3050.00,  3.00, 1,  5),
                ('2025-01-01 00:05:00.000000', '2025-01-01 00:05:00.000000', 3550.00,  3.50, 1,  5),
                ('2025-01-01 00:06:00.000000', '2025-01-01 00:06:00.000000', 4050.00,  4.00, 1,  5),
                ('2025-01-01 00:07:00.000000', '2025-01-01 00:07:00.000000', 4550.00,  4.50, 1,  5),
                ('2025-01-01 00:08:00.000000', '2025-01-01 00:08:00.000000', 5050.00,  5.00, 1,  5),
                ('2025-01-01 00:09:00.000000', '2025-01-01 00:09:00.000000', 5551.00,  5.50, 1,  5),
                ('2025-01-01 00:10:00.000000', '2025-01-01 00:10:00.000000', 6051.00,  6.00, 1,  5),
                ('2025-01-01 00:11:00.000000', '2025-01-01 00:11:00.000000', 6551.00,  6.50, 1,  5),
                ('2025-01-01 00:12:00.000000', '2025-01-01 00:12:00.000000', 7051.00,  7.00, 1,  5),
                ('2025-01-01 00:13:00.000000', '2025-01-01 00:13:00.000000', 7551.00,  7.50, 1,  5),
                ('2025-01-01 00:14:00.000000', '2025-01-01 00:14:00.000000', 8051.00,  8.00, 1,  5),
                ('2025-01-01 00:15:00.000000', '2025-01-01 00:15:00.000000', 8551.00,  8.50, 1,  5),
                ('2025-01-01 00:16:00.000000', '2025-01-01 00:16:00.000000', 9051.00,  9.00, 1,  5),
                ('2025-01-01 00:17:00.000000', '2025-01-01 00:17:00.000000', 9551.00,  9.50, 1,  5),
                ('2025-01-01 00:18:00.000000', '2025-01-01 00:18:00.000000',10051.00, 10.00, 1,  5),
                ('2025-01-01 00:19:00.000000', '2025-01-01 00:19:00.000000',10551.00, 10.50, 1,  5),
                ('2025-01-01 00:20:00.000000', '2025-01-01 00:20:00.000000',11051.00, 11.00, 1,  5),
                ('2025-01-01 00:21:00.000000', '2025-01-01 00:21:00.000000',11551.00, 11.50, 1,  5),
                ('2025-01-01 00:22:00.000000', '2025-01-01 00:22:00.000000',12051.00, 12.00, 1,  5),
                ('2025-01-01 00:23:00.000000', '2025-01-01 00:23:00.000000',12551.00, 12.50, 1,  5),
                ('2025-01-01 00:24:00.000000', '2025-01-01 00:24:00.000000',13051.00, 13.00, 1,  5),
                ('2025-01-01 00:25:00.000000', '2025-01-01 00:25:00.000000',13551.00, 13.50, 1,  5),
                ('2025-01-01 00:26:00.000000', '2025-01-01 00:26:00.000000',14051.00, 14.00, 1,  5),
                ('2025-01-01 00:27:00.000000', '2025-01-01 00:27:00.000000',14551.00, 14.50, 1,  5),
                ('2025-01-01 00:28:00.000000', '2025-01-01 00:28:00.000000',15051.00, 15.00, 1,  5),
                ('2025-01-01 00:29:00.000000', '2025-01-01 00:29:00.000000',15551.00, 15.50, 1,  5),
                ('2025-01-01 00:30:00.000000', '2025-01-01 00:30:00.000000',16051.00, 16.00, 1,  5),
                ('2025-01-01 00:31:00.000000', '2025-01-01 00:31:00.000000',16551.00, 16.50, 1,  5),
                ('2025-01-01 00:32:00.000000', '2025-01-01 00:32:00.000000',17051.00, 17.00, 1,  5),
                ('2025-01-01 00:33:00.000000', '2025-01-01 00:33:00.000000',17551.00, 17.50, 1,  5),
                ('2025-01-01 00:34:00.000000', '2025-01-01 00:34:00.000000',18051.00, 18.00, 1,  5),
                ('2025-01-01 00:35:00.000000', '2025-01-01 00:35:00.000000',18551.00, 18.50, 1,  5),
                ('2025-01-01 00:36:00.000000', '2025-01-01 00:36:00.000000',19051.00, 19.00, 1,  5),
                ('2025-01-01 00:37:00.000000', '2025-01-01 00:37:00.000000',19551.00, 19.50, 1,  5),
                ('2025-01-01 00:38:00.000000', '2025-01-01 00:38:00.000000',20051.00, 20.00, 1,  5),
                ('2025-01-01 00:00:00.000000', '2025-01-01 00:00:00.000000', 1060.00,  1.00, 1,  6),
                ('2025-01-01 00:01:00.000000', '2025-01-01 00:01:00.000000', 1560.00,  1.50, 1,  6),
                ('2025-01-01 00:02:00.000000', '2025-01-01 00:02:00.000000', 2060.00,  2.00, 1,  6),
                ('2025-01-01 00:03:00.000000', '2025-01-01 00:03:00.000000', 2560.00,  2.50, 1,  6),
                ('2025-01-01 00:04:00.000000', '2025-01-01 00:04:00.000000', 3060.00,  3.00, 1,  6),
                ('2025-01-01 00:05:00.000000', '2025-01-01 00:05:00.000000', 3560.00,  3.50, 1,  6),
                ('2025-01-01 00:06:00.000000', '2025-01-01 00:06:00.000000', 4060.00,  4.00, 1,  6),
                ('2025-01-01 00:07:00.000000', '2025-01-01 00:07:00.000000', 4560.00,  4.50, 1,  6),
                ('2025-01-01 00:08:00.000000', '2025-01-01 00:08:00.000000', 5060.00,  5.00, 1,  6),
                ('2025-01-01 00:09:00.000000', '2025-01-01 00:09:00.000000', 5561.00,  5.50, 1,  6),
                ('2025-01-01 00:10:00.000000', '2025-01-01 00:10:00.000000', 6061.00,  6.00, 1,  6),
                ('2025-01-01 00:11:00.000000', '2025-01-01 00:11:00.000000', 6561.00,  6.50, 1,  6),
                ('2025-01-01 00:12:00.000000', '2025-01-01 00:12:00.000000', 7061.00,  7.00, 1,  6),
                ('2025-01-01 00:13:00.000000', '2025-01-01 00:13:00.000000', 7561.00,  7.50, 1,  6),
                ('2025-01-01 00:14:00.000000', '2025-01-01 00:14:00.000000', 8061.00,  8.00, 1,  6),
                ('2025-01-01 00:15:00.000000', '2025-01-01 00:15:00.000000', 8561.00,  8.50, 1,  6),
                ('2025-01-01 00:16:00.000000', '2025-01-01 00:16:00.000000', 9061.00,  9.00, 1,  6),
                ('2025-01-01 00:17:00.000000', '2025-01-01 00:17:00.000000', 9561.00,  9.50, 1,  6),
                ('2025-01-01 00:18:00.000000', '2025-01-01 00:18:00.000000',10061.00, 10.00, 1,  6),
                ('2025-01-01 00:19:00.000000', '2025-01-01 00:19:00.000000',10561.00, 10.50, 1,  6),
                ('2025-01-01 00:20:00.000000', '2025-01-01 00:20:00.000000',11061.00, 11.00, 1,  6),
                ('2025-01-01 00:21:00.000000', '2025-01-01 00:21:00.000000',11561.00, 11.50, 1,  6),
                ('2025-01-01 00:22:00.000000', '2025-01-01 00:22:00.000000',12061.00, 12.00, 1,  6),
                ('2025-01-01 00:23:00.000000', '2025-01-01 00:23:00.000000',12561.00, 12.50, 1,  6),
                ('2025-01-01 00:24:00.000000', '2025-01-01 00:24:00.000000',13061.00, 13.00, 1,  6),
                ('2025-01-01 00:25:00.000000', '2025-01-01 00:25:00.000000',13561.00, 13.50, 1,  6),
                ('2025-01-01 00:26:00.000000', '2025-01-01 00:26:00.000000',14061.00, 14.00, 1,  6),
                ('2025-01-01 00:27:00.000000', '2025-01-01 00:27:00.000000',14561.00, 14.50, 1,  6),
                ('2025-01-01 00:28:00.000000', '2025-01-01 00:28:00.000000',15061.00, 15.00, 1,  6),
                ('2025-01-01 00:29:00.000000', '2025-01-01 00:29:00.000000',15561.00, 15.50, 1,  6),
                ('2025-01-01 00:30:00.000000', '2025-01-01 00:30:00.000000',16061.00, 16.00, 1,  6),
                ('2025-01-01 00:31:00.000000', '2025-01-01 00:31:00.000000',16561.00, 16.50, 1,  6),
                ('2025-01-01 00:32:00.000000', '2025-01-01 00:32:00.000000',17061.00, 17.00, 1,  6),
                ('2025-01-01 00:33:00.000000', '2025-01-01 00:33:00.000000',17561.00, 17.50, 1,  6),
                ('2025-01-01 00:34:00.000000', '2025-01-01 00:34:00.000000',18061.00, 18.00, 1,  6),
                ('2025-01-01 00:35:00.000000', '2025-01-01 00:35:00.000000',18561.00, 18.50, 1,  6),
                ('2025-01-01 00:36:00.000000', '2025-01-01 00:36:00.000000',19061.00, 19.00, 1,  6),
                ('2025-01-01 00:37:00.000000', '2025-01-01 00:37:00.000000',19561.00, 19.50, 1,  6),
                ('2025-01-01 00:38:00.000000', '2025-01-01 00:38:00.000000',20061.00, 20.00, 1,  6),
                ('2025-01-01 00:00:00.000000', '2025-01-01 00:00:00.000000', 1070.00,  1.00, 1,  7),
                ('2025-01-01 00:01:00.000000', '2025-01-01 00:01:00.000000', 1570.00,  1.50, 1,  7),
                ('2025-01-01 00:02:00.000000', '2025-01-01 00:02:00.000000', 2070.00,  2.00, 1,  7),
                ('2025-01-01 00:03:00.000000', '2025-01-01 00:03:00.000000', 2570.00,  2.50, 1,  7),
                ('2025-01-01 00:04:00.000000', '2025-01-01 00:04:00.000000', 3070.00,  3.00, 1,  7),
                ('2025-01-01 00:05:00.000000', '2025-01-01 00:05:00.000000', 3570.00,  3.50, 1,  7),
                ('2025-01-01 00:06:00.000000', '2025-01-01 00:06:00.000000', 4070.00,  4.00, 1,  7),
                ('2025-01-01 00:07:00.000000', '2025-01-01 00:07:00.000000', 4570.00,  4.50, 1,  7),
                ('2025-01-01 00:08:00.000000', '2025-01-01 00:08:00.000000', 5070.00,  5.00, 1,  7),
                ('2025-01-01 00:09:00.000000', '2025-01-01 00:09:00.000000', 5571.00,  5.50, 1,  7),
                ('2025-01-01 00:10:00.000000', '2025-01-01 00:10:00.000000', 6071.00,  6.00, 1,  7),
                ('2025-01-01 00:11:00.000000', '2025-01-01 00:11:00.000000', 6571.00,  6.50, 1,  7),
                ('2025-01-01 00:12:00.000000', '2025-01-01 00:12:00.000000', 7071.00,  7.00, 1,  7),
                ('2025-01-01 00:13:00.000000', '2025-01-01 00:13:00.000000', 7571.00,  7.50, 1,  7),
                ('2025-01-01 00:14:00.000000', '2025-01-01 00:14:00.000000', 8071.00,  8.00, 1,  7),
                ('2025-01-01 00:15:00.000000', '2025-01-01 00:15:00.000000', 8571.00,  8.50, 1,  7),
                ('2025-01-01 00:16:00.000000', '2025-01-01 00:16:00.000000', 9071.00,  9.00, 1,  7),
                ('2025-01-01 00:17:00.000000', '2025-01-01 00:17:00.000000', 9571.00,  9.50, 1,  7),
                ('2025-01-01 00:18:00.000000', '2025-01-01 00:18:00.000000',10071.00, 10.00, 1,  7),
                ('2025-01-01 00:19:00.000000', '2025-01-01 00:19:00.000000',10571.00, 10.50, 1,  7),
                ('2025-01-01 00:20:00.000000', '2025-01-01 00:20:00.000000',11071.00, 11.00, 1,  7),
                ('2025-01-01 00:21:00.000000', '2025-01-01 00:21:00.000000',11571.00, 11.50, 1,  7),
                ('2025-01-01 00:22:00.000000', '2025-01-01 00:22:00.000000',12071.00, 12.00, 1,  7),
                ('2025-01-01 00:23:00.000000', '2025-01-01 00:23:00.000000',12571.00, 12.50, 1,  7),
                ('2025-01-01 00:24:00.000000', '2025-01-01 00:24:00.000000',13071.00, 13.00, 1,  7),
                ('2025-01-01 00:25:00.000000', '2025-01-01 00:25:00.000000',13571.00, 13.50, 1,  7),
                ('2025-01-01 00:26:00.000000', '2025-01-01 00:26:00.000000',14071.00, 14.00, 1,  7),
                ('2025-01-01 00:27:00.000000', '2025-01-01 00:27:00.000000',14571.00, 14.50, 1,  7),
                ('2025-01-01 00:28:00.000000', '2025-01-01 00:28:00.000000',15071.00, 15.00, 1,  7),
                ('2025-01-01 00:29:00.000000', '2025-01-01 00:29:00.000000',15571.00, 15.50, 1,  7),
                ('2025-01-01 00:30:00.000000', '2025-01-01 00:30:00.000000',16071.00, 16.00, 1,  7),
                ('2025-01-01 00:31:00.000000', '2025-01-01 00:31:00.000000',16571.00, 16.50, 1,  7),
                ('2025-01-01 00:32:00.000000', '2025-01-01 00:32:00.000000',17071.00, 17.00, 1,  7),
                ('2025-01-01 00:33:00.000000', '2025-01-01 00:33:00.000000',17571.00, 17.50, 1,  7),
                ('2025-01-01 00:34:00.000000', '2025-01-01 00:34:00.000000',18071.00, 18.00, 1,  7),
                ('2025-01-01 00:35:00.000000', '2025-01-01 00:35:00.000000',18571.00, 18.50, 1,  7),
                ('2025-01-01 00:36:00.000000', '2025-01-01 00:36:00.000000',19071.00, 19.00, 1,  7),
                ('2025-01-01 00:37:00.000000', '2025-01-01 00:37:00.000000',19571.00, 19.50, 1,  7),
                ('2025-01-01 00:38:00.000000', '2025-01-01 00:38:00.000000',20071.00, 20.00, 1,  7),
                ('2025-01-01 00:00:00.000000', '2025-01-01 00:00:00.000000', 1080.00,  1.00, 1,  8),
                ('2025-01-01 00:01:00.000000', '2025-01-01 00:01:00.000000', 1580.00,  1.50, 1,  8),
                ('2025-01-01 00:02:00.000000', '2025-01-01 00:02:00.000000', 2080.00,  2.00, 1,  8),
                ('2025-01-01 00:03:00.000000', '2025-01-01 00:03:00.000000', 2580.00,  2.50, 1,  8),
                ('2025-01-01 00:04:00.000000', '2025-01-01 00:04:00.000000', 3080.00,  3.00, 1,  8),
                ('2025-01-01 00:05:00.000000', '2025-01-01 00:05:00.000000', 3580.00,  3.50, 1,  8),
                ('2025-01-01 00:06:00.000000', '2025-01-01 00:06:00.000000', 4080.00,  4.00, 1,  8),
                ('2025-01-01 00:07:00.000000', '2025-01-01 00:07:00.000000', 4580.00,  4.50, 1,  8),
                ('2025-01-01 00:08:00.000000', '2025-01-01 00:08:00.000000', 5080.00,  5.00, 1,  8),
                ('2025-01-01 00:09:00.000000', '2025-01-01 00:09:00.000000', 5581.00,  5.50, 1,  8),
                ('2025-01-01 00:10:00.000000', '2025-01-01 00:10:00.000000', 6081.00,  6.00, 1,  8),
                ('2025-01-01 00:11:00.000000', '2025-01-01 00:11:00.000000', 6581.00,  6.50, 1,  8),
                ('2025-01-01 00:12:00.000000', '2025-01-01 00:12:00.000000', 7081.00,  7.00, 1,  8),
                ('2025-01-01 00:13:00.000000', '2025-01-01 00:13:00.000000', 7581.00,  7.50, 1,  8),
                ('2025-01-01 00:14:00.000000', '2025-01-01 00:14:00.000000', 8081.00,  8.00, 1,  8),
                ('2025-01-01 00:15:00.000000', '2025-01-01 00:15:00.000000', 8581.00,  8.50, 1,  8),
                ('2025-01-01 00:16:00.000000', '2025-01-01 00:16:00.000000', 9081.00,  9.00, 1,  8),
                ('2025-01-01 00:17:00.000000', '2025-01-01 00:17:00.000000', 9581.00,  9.50, 1,  8),
                ('2025-01-01 00:18:00.000000', '2025-01-01 00:18:00.000000',10081.00, 10.00, 1,  8),
                ('2025-01-01 00:19:00.000000', '2025-01-01 00:19:00.000000',10581.00, 10.50, 1,  8),
                ('2025-01-01 00:20:00.000000', '2025-01-01 00:20:00.000000',11081.00, 11.00, 1,  8),
                ('2025-01-01 00:21:00.000000', '2025-01-01 00:21:00.000000',11581.00, 11.50, 1,  8),
                ('2025-01-01 00:22:00.000000', '2025-01-01 00:22:00.000000',12081.00, 12.00, 1,  8),
                ('2025-01-01 00:23:00.000000', '2025-01-01 00:23:00.000000',12581.00, 12.50, 1,  8),
                ('2025-01-01 00:24:00.000000', '2025-01-01 00:24:00.000000',13081.00, 13.00, 1,  8),
                ('2025-01-01 00:25:00.000000', '2025-01-01 00:25:00.000000',13581.00, 13.50, 1,  8),
                ('2025-01-01 00:26:00.000000', '2025-01-01 00:26:00.000000',14081.00, 14.00, 1,  8),
                ('2025-01-01 00:27:00.000000', '2025-01-01 00:27:00.000000',14581.00, 14.50, 1,  8),
                ('2025-01-01 00:28:00.000000', '2025-01-01 00:28:00.000000',15081.00, 15.00, 1,  8),
                ('2025-01-01 00:29:00.000000', '2025-01-01 00:29:00.000000',15581.00, 15.50, 1,  8),
                ('2025-01-01 00:30:00.000000', '2025-01-01 00:30:00.000000',16081.00, 16.00, 1,  8),
                ('2025-01-01 00:31:00.000000', '2025-01-01 00:31:00.000000',16581.00, 16.50, 1,  8),
                ('2025-01-01 00:32:00.000000', '2025-01-01 00:32:00.000000',17081.00, 17.00, 1,  8),
                ('2025-01-01 00:33:00.000000', '2025-01-01 00:33:00.000000',17581.00, 17.50, 1,  8),
                ('2025-01-01 00:34:00.000000', '2025-01-01 00:34:00.000000',18081.00, 18.00, 1,  8),
                ('2025-01-01 00:35:00.000000', '2025-01-01 00:35:00.000000',18581.00, 18.50, 1,  8),
                ('2025-01-01 00:36:00.000000', '2025-01-01 00:36:00.000000',19081.00, 19.00, 1,  8),
                ('2025-01-01 00:37:00.000000', '2025-01-01 00:37:00.000000',19581.00, 19.50, 1,  8),
                ('2025-01-01 00:38:00.000000', '2025-01-01 00:38:00.000000',20081.00, 20.00, 1,  8),
                ('2025-01-01 00:00:00.000000', '2025-01-01 00:00:00.000000', 1090.00,  1.00, 1,  9),
                ('2025-01-01 00:01:00.000000', '2025-01-01 00:01:00.000000', 1590.00,  1.50, 1,  9),
                ('2025-01-01 00:02:00.000000', '2025-01-01 00:02:00.000000', 2090.00,  2.00, 1,  9),
                ('2025-01-01 00:03:00.000000', '2025-01-01 00:03:00.000000', 2590.00,  2.50, 1,  9),
                ('2025-01-01 00:04:00.000000', '2025-01-01 00:04:00.000000', 3090.00,  3.00, 1,  9),
                ('2025-01-01 00:05:00.000000', '2025-01-01 00:05:00.000000', 3590.00,  3.50, 1,  9),
                ('2025-01-01 00:06:00.000000', '2025-01-01 00:06:00.000000', 4090.00,  4.00, 1,  9),
                ('2025-01-01 00:07:00.000000', '2025-01-01 00:07:00.000000', 4590.00,  4.50, 1,  9),
                ('2025-01-01 00:08:00.000000', '2025-01-01 00:08:00.000000', 5090.00,  5.00, 1,  9),
                ('2025-01-01 00:09:00.000000', '2025-01-01 00:09:00.000000', 5591.00,  5.50, 1,  9),
                ('2025-01-01 00:10:00.000000', '2025-01-01 00:10:00.000000', 6091.00,  6.00, 1,  9),
                ('2025-01-01 00:11:00.000000', '2025-01-01 00:11:00.000000', 6591.00,  6.50, 1,  9),
                ('2025-01-01 00:12:00.000000', '2025-01-01 00:12:00.000000', 7091.00,  7.00, 1,  9),
                ('2025-01-01 00:13:00.000000', '2025-01-01 00:13:00.000000', 7591.00,  7.50, 1,  9),
                ('2025-01-01 00:14:00.000000', '2025-01-01 00:14:00.000000', 8091.00,  8.00, 1,  9),
                ('2025-01-01 00:15:00.000000', '2025-01-01 00:15:00.000000', 8591.00,  8.50, 1,  9),
                ('2025-01-01 00:16:00.000000', '2025-01-01 00:16:00.000000', 9091.00,  9.00, 1,  9),
                ('2025-01-01 00:17:00.000000', '2025-01-01 00:17:00.000000', 9591.00,  9.50, 1,  9),
                ('2025-01-01 00:18:00.000000', '2025-01-01 00:18:00.000000',10091.00, 10.00, 1,  9),
                ('2025-01-01 00:19:00.000000', '2025-01-01 00:19:00.000000',10591.00, 10.50, 1,  9),
                ('2025-01-01 00:20:00.000000', '2025-01-01 00:20:00.000000',11091.00, 11.00, 1,  9),
                ('2025-01-01 00:21:00.000000', '2025-01-01 00:21:00.000000',11591.00, 11.50, 1,  9),
                ('2025-01-01 00:22:00.000000', '2025-01-01 00:22:00.000000',12091.00, 12.00, 1,  9),
                ('2025-01-01 00:23:00.000000', '2025-01-01 00:23:00.000000',12591.00, 12.50, 1,  9),
                ('2025-01-01 00:24:00.000000', '2025-01-01 00:24:00.000000',13091.00, 13.00, 1,  9),
                ('2025-01-01 00:25:00.000000', '2025-01-01 00:25:00.000000',13591.00, 13.50, 1,  9),
                ('2025-01-01 00:26:00.000000', '2025-01-01 00:26:00.000000',14091.00, 14.00, 1,  9),
                ('2025-01-01 00:27:00.000000', '2025-01-01 00:27:00.000000',14591.00, 14.50, 1,  9),
                ('2025-01-01 00:28:00.000000', '2025-01-01 00:28:00.000000',15091.00, 15.00, 1,  9),
                ('2025-01-01 00:29:00.000000', '2025-01-01 00:29:00.000000',15591.00, 15.50, 1,  9),
                ('2025-01-01 00:30:00.000000', '2025-01-01 00:30:00.000000',16091.00, 16.00, 1,  9),
                ('2025-01-01 00:31:00.000000', '2025-01-01 00:31:00.000000',16591.00, 16.50, 1,  9),
                ('2025-01-01 00:32:00.000000', '2025-01-01 00:32:00.000000',17091.00, 17.00, 1,  9),
                ('2025-01-01 00:33:00.000000', '2025-01-01 00:33:00.000000',17591.00, 17.50, 1,  9),
                ('2025-01-01 00:34:00.000000', '2025-01-01 00:34:00.000000',18091.00, 18.00, 1,  9),
                ('2025-01-01 00:35:00.000000', '2025-01-01 00:35:00.000000',18591.00, 18.50, 1,  9),
                ('2025-01-01 00:36:00.000000', '2025-01-01 00:36:00.000000',19091.00, 19.00, 1,  9),
                ('2025-01-01 00:37:00.000000', '2025-01-01 00:37:00.000000',19591.00, 19.50, 1,  9),
                ('2025-01-01 00:38:00.000000', '2025-01-01 00:38:00.000000',20091.00, 20.00, 1,  9),
                ('2025-01-01 00:00:00.000000', '2025-01-01 00:00:00.000000', 1099.00,  1.00, 1,  10),
                ('2025-01-01 00:01:00.000000', '2025-01-01 00:01:00.000000', 1599.00,  1.50, 1,  10),
                ('2025-01-01 00:02:00.000000', '2025-01-01 00:02:00.000000', 2099.00,  2.00, 1,  10),
                ('2025-01-01 00:03:00.000000', '2025-01-01 00:03:00.000000', 2599.00,  2.50, 1,  10),
                ('2025-01-01 00:04:00.000000', '2025-01-01 00:04:00.000000', 3099.00,  3.00, 1,  10),
                ('2025-01-01 00:05:00.000000', '2025-01-01 00:05:00.000000', 3599.00,  3.50, 1,  10),
                ('2025-01-01 00:06:00.000000', '2025-01-01 00:06:00.000000', 4099.00,  4.00, 1,  10),
                ('2025-01-01 00:07:00.000000', '2025-01-01 00:07:00.000000', 4599.00,  4.50, 1,  10),
                ('2025-01-01 00:08:00.000000', '2025-01-01 00:08:00.000000', 5099.00,  5.00, 1,  10),
                ('2025-01-01 00:09:00.000000', '2025-01-01 00:09:00.000000', 5599.00,  5.50, 1,  10),
                ('2025-01-01 00:10:00.000000', '2025-01-01 00:10:00.000000', 6099.00,  6.00, 1,  10),
                ('2025-01-01 00:11:00.000000', '2025-01-01 00:11:00.000000', 6599.00,  6.50, 1,  10),
                ('2025-01-01 00:12:00.000000', '2025-01-01 00:12:00.000000', 7099.00,  7.00, 1,  10),
                ('2025-01-01 00:13:00.000000', '2025-01-01 00:13:00.000000', 7599.00,  7.50, 1,  10),
                ('2025-01-01 00:14:00.000000', '2025-01-01 00:14:00.000000', 8099.00,  8.00, 1,  10),
                ('2025-01-01 00:15:00.000000', '2025-01-01 00:15:00.000000', 8599.00,  8.50, 1,  10),
                ('2025-01-01 00:16:00.000000', '2025-01-01 00:16:00.000000', 9099.00,  9.00, 1,  10),
                ('2025-01-01 00:17:00.000000', '2025-01-01 00:17:00.000000', 9599.00,  9.50, 1,  10),
                ('2025-01-01 00:18:00.000000', '2025-01-01 00:18:00.000000',10099.00, 10.00, 1,  10),
                ('2025-01-01 00:19:00.000000', '2025-01-01 00:19:00.000000',10599.00, 10.50, 1,  10),
                ('2025-01-01 00:20:00.000000', '2025-01-01 00:20:00.000000',11099.00, 11.00, 1,  10),
                ('2025-01-01 00:21:00.000000', '2025-01-01 00:21:00.000000',11599.00, 11.50, 1,  10),
                ('2025-01-01 00:22:00.000000', '2025-01-01 00:22:00.000000',12099.00, 12.00, 1,  10),
                ('2025-01-01 00:23:00.000000', '2025-01-01 00:23:00.000000',12599.00, 12.50, 1,  10),
                ('2025-01-01 00:24:00.000000', '2025-01-01 00:24:00.000000',13099.00, 13.00, 1,  10),
                ('2025-01-01 00:25:00.000000', '2025-01-01 00:25:00.000000',13599.00, 13.50, 1,  10),
                ('2025-01-01 00:26:00.000000', '2025-01-01 00:26:00.000000',14099.00, 14.00, 1,  10),
                ('2025-01-01 00:27:00.000000', '2025-01-01 00:27:00.000000',14599.00, 14.50, 1,  10),
                ('2025-01-01 00:28:00.000000', '2025-01-01 00:28:00.000000',15099.00, 15.00, 1,  10),
                ('2025-01-01 00:29:00.000000', '2025-01-01 00:29:00.000000',15599.00, 15.50, 1,  10),
                ('2025-01-01 00:30:00.000000', '2025-01-01 00:30:00.000000',16099.00, 16.00, 1,  10),
                ('2025-01-01 00:31:00.000000', '2025-01-01 00:31:00.000000',16599.00, 16.50, 1,  10),
                ('2025-01-01 00:32:00.000000', '2025-01-01 00:32:00.000000',17099.00, 17.00, 1,  10),
                ('2025-01-01 00:33:00.000000', '2025-01-01 00:33:00.000000',17599.00, 17.50, 1,  10),
                ('2025-01-01 00:34:00.000000', '2025-01-01 00:34:00.000000',18099.00, 18.00, 1,  10),
                ('2025-01-01 00:35:00.000000', '2025-01-01 00:35:00.000000',18599.00, 18.50, 1,  10),
                ('2025-01-01 00:36:00.000000', '2025-01-01 00:36:00.000000',19099.00, 19.00, 1,  10),
                ('2025-01-01 00:37:00.000000', '2025-01-01 00:37:00.000000',19599.00, 19.50, 1,  10),
                ('2025-01-01 00:38:00.000000', '2025-01-01 00:38:00.000000',20099.00, 20.00, 1,  10)
                """;
        jdbcTemplate.execute(sql3);
    }


    @Test
    @DisplayName("셀러 회원가입 성공")
    @Order(1)
    void signupSeller() throws Exception {
        SellerSignupRequest request = new SellerSignupRequest(
                "seller@example.com", "password123", "SELLER", "성", "이름",
                "01012345678", "셀러회사", "0987654321", "02-5678-1234",
                new AuthAddressRequest("KR", "Seoul", "Jongno", "도로명", "상세주소", "03001")
        );

        mockMvc.perform(post("/api/v1/auth/sellers/signup")
                        .contentType(MediaType.APPLICATION_JSON)
                        .content(objectMapper.writeValueAsString(request)))
                .andExpect(status().isCreated());
    }

    @Test
    @Order(2)
    @DisplayName("로그인 성공")
    void loginSuccess() throws Exception {
        // 먼저 회원가입 선행 필요
        //signupSeller();  // 또는 signupPartner()
        LoginRequest sellerRequest = new LoginRequest("seller@example.com", "password123");

        MvcResult res = mockMvc.perform(post("/api/v1/auth/login")
                        .contentType(MediaType.APPLICATION_JSON)
                        .content(objectMapper.writeValueAsString(sellerRequest)))
                .andExpect(status().isCreated())
                .andReturn();
        String responseBody = res.getResponse().getContentAsString();
        JsonNode root = objectMapper.readTree(responseBody);
        jwt = root.path("data").path("accessToken").asText();
    }

    @Test
    @Order(3)
    @DisplayName("엑셀파일로 다건 주문 생성")
    void excelUpload() throws Exception {
        File file = new File("src/test/resources/test_100.xlsx"); // 테스트용 엑셀 파일
        MockMultipartFile multipartFile = new MockMultipartFile(
                "file",                             // @RequestParam name
                "test_100.xlsx",                  // original filename
                "application/vnd.openxmlformats-officedocument.spreadsheetml.sheet", // MIME type
                new FileInputStream(file)           // file contents
        );

        // when & then
        mockMvc.perform(multipart("/api/v3/orders/upload")
                        .file(multipartFile)
                        .header("Authorization", "Bearer " + jwt)
                        .contentType(MediaType.MULTIPART_FORM_DATA))
                .andExpect(status().isCreated())
                .andExpect(jsonPath("$.data.length()").value(149));

    }

    @Test
    @Order(4)
    @DisplayName("오더조회한다")
    void getOrders() throws Exception {
        MvcResult res = mockMvc.perform(get("/api/v1/orders")
                .header("Authorization", "Bearer " + jwt)
                .contentType(MediaType.APPLICATION_JSON))
                .andExpect(status().isOk())
                .andReturn();
        String responseBody = res.getResponse().getContentAsString();
        JsonNode root = objectMapper.readTree(responseBody);
        JsonNode dataNode = root.path("data"); // 반드시 "data"로 들어가야 함

        PageResponseDto<OrderListResponse> result = objectMapper
                .readerFor(new TypeReference<PageResponseDto<OrderListResponse>>() {})
                .readValue(dataNode.toString());

        assertThat(result.getTotalElements()).isEqualTo(149);

    }

    @Test
    @Order(5)
    @DisplayName("결제하기")
    void pay() throws Exception {
        MultiPaymentConfirmRequest.MultiOrderRequest order1 =
                new MultiPaymentConfirmRequest.MultiOrderRequest(1L, 30000);
        MultiPaymentConfirmRequest.MultiOrderRequest order2 =
                new MultiPaymentConfirmRequest.MultiOrderRequest(2L, 20000);

        MultiPaymentConfirmRequest request = new MultiPaymentConfirmRequest(
                "tgen_20250702120156mL3w6",
                "MC4xOTExODE1MTg4MzY4",
                List.of(order1, order2),
                "KRW"
        );
        mockMvc.perform(post("/api/v1/payments/multi")
                        .contentType(MediaType.APPLICATION_JSON)
                        .header("Authorization", "Bearer " + jwt)
                        .content(objectMapper.writeValueAsString(request)))
                .andExpect(status().isOk())
                .andExpect(jsonPath("$.code").value(200))
                .andExpect(jsonPath("$.message").value("다건 결제가 승인되었습니다."));
    }

}
